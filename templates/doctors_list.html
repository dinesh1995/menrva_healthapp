{% include 'header.html' %}
{% include 'navbar.html' %}
{% include 'flash.html' %}
<style>
body{
    background:#DCDCDC;
}
.card-box {
    padding: 20px;
    border-radius: 3px;
    margin-bottom: 30px;
    background-color: #fff;
}

.social-links li a {
    border-radius: 50%;
    color: rgba(121, 121, 121, .8);
    display: inline-block;
    height: 30px;
    line-height: 27px;
    border: 2px solid rgba(121, 121, 121, .5);
    text-align: center;
    width: 30px
}

.social-links li a:hover {
    color: #797979;
    border: 2px solid #797979
}
.thumb-lg {
    height: 88px;
    width: 88px;
}
.img-thumbnail {
    padding: .25rem;
    background-color: #fff;
    border: 1px solid #dee2e6;
    border-radius: .25rem;
    max-width: 100%;
    height: auto;
}
.text-pink {
    color: #ff679b!important;
}
.btn-rounded {
    border-radius: 2em;
}
.text-muted {
    color: #98a6ad!important;
}
h4 {
    line-height: 22px;
    font-size: 18px;
}
</style>

<div class="content">
    <div class="container">
    	<br>
    	<div class="page-header">
	    	<h3>Registered Doctors</h3>      
	  	</div>
	  	<br>
    	{% for detail in data['data'] %}
    		{% if loop.index % 3 == 1 %}{% set close = 0 %}<div class="row">{% endif %}
            <div class="col-lg-4">
                <div class="text-center card-box">
                    <div class="member-card pt-2 pb-2">
                        <div class="thumb-lg member-thumb mx-auto"><img src="https://bootdey.com/img/Content/avatar/avatar7.png" class="rounded-circle img-thumbnail" alt="profile-image"></div>
                        <div class="">
                            <h4><a href="/ui/user/{{detail['id']}}">{{ detail['name'] }}</a></h4>
                            <p class="text-muted">({{ detail['profession'] }})</p>
                            <p class="text-muted"><span><a href="mailto:{{ detail['email'] }}" class="text-pink">{{ detail['email'] }}</a></span> | {{ detail['city'] }}</p>
                        </div>
                        <ul class="social-links list-inline">
                            <li class="list-inline-item"><a title="" data-placement="top" data-toggle="tooltip" class="tooltips" href="" data-original-title="Facebook"><i class="fa fa-facebook"></i></a></li>
                            <li class="list-inline-item"><a title="" data-placement="top" data-toggle="tooltip" class="tooltips" href="" data-original-title="Twitter"><i class="fa fa-twitter"></i></a></li>
                            <li class="list-inline-item"><a title="" data-placement="top" data-toggle="tooltip" class="tooltips" href="" data-original-title="Skype"><i class="fa fa-skype"></i></a></li>
                        </ul>
                        <button type="button" class="btn btn-primary mt-3 btn-rounded waves-effect w-md waves-light book-btn" data-toggle="modal" data-target="#bookapmtModal" id="{{detail['id']}}" data-name="{{detail['name']}}">Book Appointment</button>
                    </div>
                </div>
            </div>
        	{% if loop.index % 3 == 0 %}{% set close = 1 %}</div>{% endif %}
        {% endfor %}
    	{% if close == 0 %}</div>{% endif %}
    	</div>
        <!-- end row -->
        <!-- <div class="row">
            <div class="col-12">
                <div class="text-right">
                    <ul class="pagination pagination-split mt-0 float-right">
                        <li class="page-item"><a class="page-link" href="#" aria-label="Previous"><span aria-hidden="true">«</span> <span class="sr-only">Previous</span></a></li>
                        <li class="page-item active"><a class="page-link" href="#">1</a></li>
                        <li class="page-item"><a class="page-link" href="#">2</a></li>
                        <li class="page-item"><a class="page-link" href="#">3</a></li>
                        <li class="page-item"><a class="page-link" href="#">4</a></li>
                        <li class="page-item"><a class="page-link" href="#">5</a></li>
                        <li class="page-item"><a class="page-link" href="#" aria-label="Next"><span aria-hidden="true">»</span> <span class="sr-only">Next</span></a></li>
                    </ul>
                </div>
            </div>
        </div> -->
        <!-- end row -->
    </div>
    <!-- container -->
</div>


<!-- The Book Appointment Modal -->
<div class="modal" id="bookapmtModal">
  <div class="modal-dialog">
    <div class="modal-content">

      <!-- Modal Header -->
      <div class="modal-header">
        <h4 class="modal-title">Book Appointment</h4>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>

      <!-- Modal body -->
      <div class="modal-body">
		<div class="input-append date form_datetime">
			<div class="container">
				<div class="row">
                    <input type="hidden" doctor-id="" id="doctor-id"/>
					<div class="column">From:&nbsp</div>
					<div class="column">
				    	<input data-date-format="dd/mm/yyyy" id="from-date" class="datepicker form-control">
				    </div>
				    <div class="column ml-2">
					    <select id="from-time" class="timepicker form-control">
					    	<option value="09:00">09:00</option>
					    	<option value="10:00">10:00</option>
					    	<option value="11:00">11:00</option>
					    	<option value="12:00">12:00</option>
					    	<option value="13:00">13:00</option>
					    	<option value="14:00">14:00</option>
					    	<option value="15:00">15:00</option>
					    	<option value="16:00">16:00</option>
					    	<option value="17:00">17:00</option>
					    	<option value="18:00">18:00</option>
					    	<option value="19:00">19:00</option>
					    	<option value="20:00">20:00</option>
					    	<option value="21:00">21:00</option>
					    </select>
					</div>
			    </div>
			    <br>
			    <div class="row">
			    	<div class="column">To:&nbsp&nbsp&nbsp&nbsp&nbsp</div>
			    	<div class="column">
			    		<input data-date-format="dd/mm/yyyy" id="to-date" class="datepicker form-control">
			    	</div>
			    	<div class="column ml-2">
					    <select id="to-time" class="timepicker form-control">
					    	<option value="10:00">10:00</option>
					    	<option value="11:00">11:00</option>
					    	<option value="12:00">12:00</option>
					    	<option value="13:00">13:00</option>
					    	<option value="14:00">14:00</option>
					    	<option value="15:00">15:00</option>
					    	<option value="16:00">16:00</option>
					    	<option value="17:00">17:00</option>
					    	<option value="18:00">18:00</option>
					    	<option value="19:00">19:00</option>
					    	<option value="20:00">20:00</option>
					    	<option value="21:00">21:00</option>
					    </select>
					</div>
				</div>
			</div>
		</div>
        <div id="respone-text" class="mt-2">
            
        </div>            
      </div>

      <!-- Modal footer -->
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" id="book-apmt-btn" onclick=(book_apmt(this))>Book</button>
        <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
      </div>

    </div>
  </div>
</div>

<script type="text/javascript">
	$(function() {
	  $('.book-btn').click(function(event) {
	    event.preventDefault();
	    $('.modal-title').text("Book Appointment with " + $(this).attr('data-name'))
	    $('#doctor-id').attr('doctor-id', $(this).attr('id'));
	  });
	});

	$('.datepicker').datepicker({
        weekStart: 1,
        daysOfWeekHighlighted: "6,0",
        autoclose: true,
        todayHighlight: true,
        format: 'yyyy-mm-dd'
    });
    $('.datepicker').datepicker("setDate", new Date());

    function book_apmt(event){
        $('#book-apmt-btn').attr('disabled',true);
        $('#book-apmt-btn').text('Booking...');
        var from_date = $('#from-date').val();
        var from_time = $('#from-time').val();
        var to_date = $('#to-date').val();
        var to_time = $('#to-time').val();
        var doctor_id = $('#doctor-id').attr('doctor-id');
        $.ajax({
            type: 'POST',
            url: '/ui/book_appointment',
            data: {
                'from_date': from_date, 'from_time': from_time, 'to_date': to_date, 'to_time': to_time, 'doctor_id': doctor_id
            },
            success: function(response) {
                if(response.success == 'true'){
                    $('#respone-text').html('<p>Appointment booked successfully! Click <a href="/ui/appointments">here</a> to view</p>')
                    $('#book-apmt-btn').text('Done');
                }
                else{
                    $('#respone-text').html('<p>Error in booking Appointment! Try again later</p>')
                }
            },
            error: function(){
                $('#respone-text').html('<p>Error in booking Appointment! Try again later</p>')
            }
        });
    }

</script>
{% include 'footer.html' %}
